<header>KHQR Payment</header>
<div class="container card" id="pay"></div>

<script src="app.js"></script>
<script src="khqr.js"></script>
<script>
const cart = getCart();
if (!cart.length) {
  document.getElementById("pay").innerText = "ไม่มีออเดอร์";
  throw "";
}

const orderId = "ORD" + Date.now();
const total =
  subtotal() +
  shippingCost(subtotal()) -
  discountAmount(subtotal());

const qr = buildKHQR({ amount: total, orderId });

document.getElementById("pay").innerHTML = `
<p>Order: ${orderId}</p>
<p><b>${total}៛</b></p>
<img src="https://api.qrserver.com/v1/create-qr-code/?size=320x320&data=${qr}">
<br><br>
<button onclick="finish()">ฉันชำระแล้ว</button>
`;

function finish() {
  clearCart();
  location.href = "success.html?o=" + orderId;
}
</script>
